apiVersion: v1
kind: ConfigMap
metadata:
  name: phase7-config
  namespace: jorge-phase7
  labels:
    app: phase7-config
    phase: "7"
    component: configuration
data:
  # Jorge Methodology Configuration
  jorge-methodology.yaml: |
    methodology:
      name: "Jorge's Confrontational Qualification"
      version: "7.0.0"
      commission_rate: 0.06
      enhancement_weight: 0.35
      confidence_threshold: 0.85

    core_questions:
      - "What's your timeline for selling?"
      - "What's your bottom line price?"
      - "Are you prepared to move quickly?"
      - "What happens if we don't sell?"

    temperature_thresholds:
      hot: 75
      warm: 50
      lukewarm: 25
      cold: 0

    optimization_targets:
      conversion_improvement: 0.28
      deal_value_increase: 0.40
      time_to_close_reduction: 0.30

  # Revenue Intelligence Configuration
  revenue-intelligence.yaml: |
    forecasting:
      models:
        - prophet
        - arima
        - lstm
        - ensemble
      prediction_horizon: 90  # days
      confidence_interval: 0.95
      update_frequency: 3600  # seconds

    commission_defense:
      market_rate: 0.025
      jorge_premium: 1.40  # 140% of market
      defense_strategies:
        - value_demonstration
        - performance_metrics
        - roi_analysis
        - urgency_creation

    kpi_targets:
      monthly_revenue_growth: 0.15
      conversion_rate_improvement: 0.20
      deal_value_increase: 0.25
      client_satisfaction: 0.90

  # Business Intelligence Configuration
  business-intelligence.yaml: |
    dashboard:
      refresh_interval: 30  # seconds
      cache_ttl: 300  # seconds
      max_concurrent_users: 100

    analytics:
      conversation_analysis_enabled: true
      sentiment_tracking: true
      performance_benchmarking: true
      predictive_alerts: true

    streaming:
      websocket_enabled: true
      buffer_size: 1000
      heartbeat_interval: 30
      connection_timeout: 300

  # Market Intelligence Configuration
  market-intelligence.yaml: |
    automation:
      trend_detection_interval: 1800  # seconds
      market_analysis_depth: "comprehensive"
      competitive_monitoring: true
      opportunity_identification: true

    prediction:
      forecast_horizon: 14  # days
      trend_confidence_threshold: 0.80
      alert_threshold: 0.75

    jorge_integration:
      methodology_weight: 0.35
      market_positioning: "premium"
      competitive_advantage_tracking: true

  # Conversation Analytics Configuration
  conversation-analytics.yaml: |
    analysis:
      real_time_processing: true
      sentiment_analysis: true
      intent_detection: true
      performance_tracking: true

    jorge_methodology:
      confrontational_score_weight: 0.40
      urgency_creation_tracking: true
      objection_handling_analysis: true
      qualification_effectiveness: true

    ml_models:
      sentiment_model: "distilbert-base-uncased"
      intent_model: "jorge-intent-classifier-v7"
      performance_model: "jorge-performance-predictor-v7"

  # Streaming Configuration
  streaming.yaml: |
    websockets:
      max_connections: 1000
      message_buffer_size: 1000
      heartbeat_interval: 30
      connection_timeout: 300

    events:
      revenue_alerts: true
      performance_updates: true
      market_changes: true
      conversation_insights: true

    processing:
      batch_size: 100
      processing_interval: 1  # seconds
      retry_attempts: 3

  # Cache Configuration
  cache.yaml: |
    intelligent_caching:
      predictive_warming: true
      ml_based_eviction: true
      hit_rate_target: 0.95
      warming_threshold: 0.70

    redis:
      key_prefix: "jorge_phase7"
      default_ttl: 3600  # seconds
      max_memory_policy: "allkeys-lru"

    warming_strategies:
      - user_behavior_prediction
      - temporal_patterns
      - correlation_analysis
      - jorge_methodology_optimization

---
apiVersion: v1
kind: ConfigMap
metadata:
  name: phase7-ml-models
  namespace: jorge-phase7
  labels:
    app: phase7-ml-models
    phase: "7"
    component: machine-learning
data:
  model-registry.yaml: |
    models:
      revenue_forecasting:
        name: "Jorge Revenue Forecasting Ensemble v7.0"
        type: "ensemble"
        components:
          - prophet
          - arima
          - lstm
        accuracy: 0.94
        latency: "< 25ms"
        last_trained: "2024-01-15"

      conversation_intelligence:
        name: "Jorge Conversation Intelligence v7.0"
        type: "transformer"
        architecture: "distilbert"
        accuracy: 0.96
        jorge_enhancement: 1.35
        last_trained: "2024-01-12"

      market_intelligence:
        name: "Jorge Market Intelligence v7.0"
        type: "ensemble"
        prediction_horizon: "14 days"
        accuracy: 0.89
        trend_detection: 0.92
        last_trained: "2024-01-10"

      deal_probability:
        name: "Jorge Deal Probability Engine v7.0"
        type: "gradient_boosting"
        features: 28
        accuracy: 0.91
        jorge_methodology_weight: 0.35
        last_trained: "2024-01-08"

  performance-targets.yaml: |
    latency_targets:
      revenue_forecasting: "< 25ms"
      conversation_analysis: "< 50ms"
      market_intelligence: "< 100ms"
      deal_probability: "< 30ms"
      cache_operations: "< 5ms"

    accuracy_targets:
      revenue_forecasting: "> 94%"
      conversation_intelligence: "> 96%"
      market_intelligence: "> 89%"
      deal_probability: "> 91%"

    throughput_targets:
      requests_per_second: 10000
      concurrent_users: 1000
      predictions_per_second: 1000
      cache_hit_rate: "> 95%"

---
apiVersion: v1
kind: Secret
metadata:
  name: phase7-secrets
  namespace: jorge-phase7
  labels:
    app: phase7-secrets
    phase: "7"
    component: secrets
type: Opaque
stringData:
  # Database Configuration (Base64 encoded in production)
  postgres-url: "postgresql://user:password@postgres-cluster:5432/jorge_phase7"
  redis-url: "redis://redis-cluster:6379/7"

  # API Keys (Base64 encoded in production)
  claude-api-key: "sk-ant-api03-PLACEHOLDER-KEY"
  openai-api-key: "sk-PLACEHOLDER-OPENAI-KEY"

  # JWT Configuration
  jwt-secret: "jorge-phase7-jwt-secret-key-2024"
  jwt-algorithm: "HS256"
  jwt-expiration: "3600"

  # External Service Configuration
  aws-access-key: "AKIAIOSFODNN7EXAMPLE"
  aws-secret-key: "wJalrXUtnFEMI/K7MDENG/bPxRfiCYEXAMPLEKEY"
  aws-region: "us-east-1"

  # Monitoring and Observability
  datadog-api-key: "placeholder-datadog-api-key"
  newrelic-license-key: "placeholder-newrelic-license"

  # Security Configuration
  encryption-key: "jorge-phase7-encryption-key-2024"
  api-rate-limit-secret: "rate-limit-secret-key"

---
apiVersion: v1
kind: Secret
metadata:
  name: metrics-auth
  namespace: jorge-phase7
  labels:
    app: metrics-auth
    component: monitoring
type: Opaque
stringData:
  auth: "admin:$2a$10$2b2cU8CPhOTaGrs1HRQuAueS7JTT5ZHsHSzYiFPm1leZck7Mc8T4W"  # admin:secret

---
apiVersion: v1
kind: ConfigMap
metadata:
  name: phase7-nginx-config
  namespace: jorge-phase7
  labels:
    app: phase7-nginx
    component: load-balancer
data:
  nginx.conf: |
    upstream phase7_revenue {
        least_conn;
        server revenue-intelligence-service:8000 weight=5;
        keepalive 32;
    }

    upstream phase7_bi {
        least_conn;
        server business-intelligence-service:8001 weight=5;
        keepalive 32;
    }

    upstream phase7_analytics {
        least_conn;
        server conversation-analytics-service:8002 weight=5;
        keepalive 32;
    }

    upstream phase7_market {
        least_conn;
        server market-intelligence-service:8003 weight=5;
        keepalive 32;
    }

    upstream phase7_streaming {
        least_conn;
        server stream-processor-service:8004 weight=5;
        keepalive 32;
    }

    upstream phase7_cache {
        least_conn;
        server cache-service-service:8005 weight=5;
        keepalive 32;
    }

    server {
        listen 8080;
        server_name _;

        # Security headers
        add_header X-Frame-Options DENY;
        add_header X-Content-Type-Options nosniff;
        add_header X-XSS-Protection "1; mode=block";
        add_header Strict-Transport-Security "max-age=31536000; includeSubDomains";

        # Rate limiting
        limit_req_zone $binary_remote_addr zone=api:10m rate=100r/m;
        limit_req zone=api burst=20 nodelay;

        location /revenue {
            proxy_pass http://phase7_revenue;
            include /etc/nginx/proxy_params;
        }

        location /business-intelligence {
            proxy_pass http://phase7_bi;
            include /etc/nginx/proxy_params;
        }

        location /analytics {
            proxy_pass http://phase7_analytics;
            include /etc/nginx/proxy_params;
        }

        location /market {
            proxy_pass http://phase7_market;
            include /etc/nginx/proxy_params;
        }

        location /streaming {
            proxy_pass http://phase7_streaming;
            include /etc/nginx/proxy_params;
        }

        location /cache {
            proxy_pass http://phase7_cache;
            include /etc/nginx/proxy_params;
        }

        location /health {
            access_log off;
            return 200 "healthy\n";
            add_header Content-Type text/plain;
        }
    }

  proxy_params: |
    proxy_set_header Host $http_host;
    proxy_set_header X-Real-IP $remote_addr;
    proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
    proxy_set_header X-Forwarded-Proto $scheme;
    proxy_connect_timeout 30s;
    proxy_send_timeout 30s;
    proxy_read_timeout 30s;
    proxy_buffering on;
    proxy_buffer_size 4k;
    proxy_buffers 8 4k;