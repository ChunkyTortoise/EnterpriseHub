# ==============================================================================
# JORGE'S BI DASHBOARD PRODUCTION CONFIGURATION
# Enterprise-Grade Business Intelligence Platform
# ==============================================================================
#
# DEPLOYMENT INSTRUCTIONS:
# 1. Copy this file to .env.bi.production
# 2. Replace ALL placeholder values with actual production values
# 3. Validate configuration: python scripts/validate-bi-config.py
# 4. Deploy with: docker-compose -f docker-compose.bi.production.yml up -d
#
# SECURITY REQUIREMENTS:
# - All secrets must be minimum 32 characters
# - API keys must be production-grade
# - Database connections must use SSL
# - Redis must have authentication enabled
# - All HTTP traffic must be HTTPS only
#

# ==============================================================================
# ENVIRONMENT IDENTIFICATION
# ==============================================================================
ENVIRONMENT=production
SERVICE_NAME=jorge-bi-dashboard
VERSION=2.0.0
DEPLOYMENT_STAGE=production
DEBUG=false
LOG_LEVEL=INFO

# ==============================================================================
# CORE DATABASE CONNECTIONS
# ==============================================================================
# PostgreSQL with OLAP Schema (Production)
DATABASE_URL=postgresql://jorge_bi_user:${POSTGRES_PASSWORD}@postgres-cluster:5432/jorge_bi_production?sslmode=require

# Database Pool Configuration (Production Optimized)
DB_POOL_SIZE=20
DB_MAX_OVERFLOW=30
DB_POOL_TIMEOUT=30
DB_POOL_RECYCLE=3600
DB_ECHO=false

# Read Replicas for Analytics Queries
DATABASE_READ_URL=postgresql://jorge_bi_reader:${POSTGRES_READ_PASSWORD}@postgres-read-replica:5432/jorge_bi_production?sslmode=require

# ==============================================================================
# REDIS CACHE & SESSION STORE
# ==============================================================================
# Redis Cluster for High Availability
REDIS_URL=redis://default:${REDIS_PASSWORD}@redis-cluster:6379/0
REDIS_CLUSTER_NODES=redis-cluster:6379,redis-cluster:6380,redis-cluster:6381

# Redis Connection Pool
REDIS_MAX_CONNECTIONS=50
REDIS_RETRY_ON_TIMEOUT=true
REDIS_SOCKET_TIMEOUT=5
REDIS_SOCKET_CONNECT_TIMEOUT=10
REDIS_HEALTH_CHECK_INTERVAL=30

# Cache Configuration
CACHE_TTL_DASHBOARD=300        # 5 minutes
CACHE_TTL_REVENUE=600         # 10 minutes
CACHE_TTL_BOT_PERFORMANCE=180 # 3 minutes
CACHE_TTL_PREDICTIVE=1800     # 30 minutes

# ==============================================================================
# AI SERVICE CONFIGURATION
# ==============================================================================
# Anthropic Claude API (Production Key)
ANTHROPIC_API_KEY=${ANTHROPIC_PROD_API_KEY}
ANTHROPIC_MODEL=claude-3-sonnet-20241022
ANTHROPIC_MAX_TOKENS=4096
ANTHROPIC_TEMPERATURE=0.7
ANTHROPIC_TIMEOUT=30

# OpenAI Backup (if needed)
OPENAI_API_KEY=${OPENAI_PROD_API_KEY}
OPENAI_MODEL=gpt-4-turbo-preview

# ==============================================================================
# GHL INTEGRATION
# ==============================================================================
# Jorge's GoHighLevel Credentials
GHL_LOCATION_ID=${JORGE_GHL_LOCATION_ID}
GHL_API_KEY=${JORGE_GHL_API_KEY}
GHL_AGENCY_KEY=${JORGE_GHL_AGENCY_KEY}

# GHL API Configuration
GHL_API_VERSION=2.0
GHL_BASE_URL=https://services.leadconnectorhq.com
GHL_WEBHOOK_SECRET=${GHL_WEBHOOK_SECRET}
GHL_RATE_LIMIT=1000
GHL_TIMEOUT=30

# ==============================================================================
# SECURITY & AUTHENTICATION
# ==============================================================================
# JWT Configuration (Production Strength)
JWT_SECRET_KEY=${JWT_SECRET_PRODUCTION}
JWT_ALGORITHM=HS256
JWT_ACCESS_TOKEN_EXPIRE_MINUTES=30
JWT_REFRESH_TOKEN_EXPIRE_DAYS=7

# API Security
API_KEY_HEADER=X-API-Key
API_RATE_LIMIT=1000
API_RATE_WINDOW=3600
CORS_ORIGINS=https://bi.jorge-platform.com,https://dashboard.jorge-platform.com
CORS_ALLOW_CREDENTIALS=true

# Encryption Keys
DATA_ENCRYPTION_KEY=${AES_256_KEY}
FIELD_ENCRYPTION_SALT=${ENCRYPTION_SALT}

# ==============================================================================
# WEBSOCKET CONFIGURATION
# ==============================================================================
# WebSocket Server Settings
WS_MAX_CONNECTIONS=1000
WS_MESSAGE_QUEUE_SIZE=10000
WS_HEARTBEAT_INTERVAL=30
WS_CONNECTION_TIMEOUT=300
WS_MAX_MESSAGE_SIZE=1048576  # 1MB

# Real-time Event Configuration
EVENT_BATCH_SIZE=100
EVENT_FLUSH_INTERVAL=5
EVENT_MAX_RETRY_ATTEMPTS=3
EVENT_DEAD_LETTER_TTL=86400

# ==============================================================================
# PERFORMANCE OPTIMIZATION
# ==============================================================================
# API Response Optimization
API_RESPONSE_TIMEOUT=30
API_MAX_CONCURRENT_REQUESTS=500
API_REQUEST_BUFFER_SIZE=8192

# ML Analytics Performance
ML_PREDICTION_TIMEOUT=5
ML_BATCH_SIZE=1000
ML_CACHE_PREDICTIONS=true
ML_CACHE_TTL=3600

# Background Processing
BACKGROUND_WORKER_CONCURRENCY=10
BACKGROUND_QUEUE_SIZE=1000
BACKGROUND_TASK_TIMEOUT=300

# ==============================================================================
# MONITORING & OBSERVABILITY
# ==============================================================================
# Application Monitoring
ENABLE_METRICS=true
METRICS_ENDPOINT=/metrics
HEALTH_CHECK_ENDPOINT=/health
READY_CHECK_ENDPOINT=/ready

# Logging Configuration
LOG_FORMAT=json
LOG_ROTATION=midnight
LOG_RETENTION_DAYS=30
LOG_MAX_SIZE_MB=100

# Distributed Tracing
JAEGER_ENABLED=true
JAEGER_ENDPOINT=${JAEGER_COLLECTOR_URL}
JAEGER_SERVICE_NAME=jorge-bi-dashboard
JAEGER_SAMPLE_RATE=0.1

# Performance Monitoring
PROMETHEUS_ENABLED=true
PROMETHEUS_METRICS_PATH=/metrics
PROMETHEUS_PUSH_GATEWAY=${PROMETHEUS_PUSH_GATEWAY_URL}

# ==============================================================================
# BUSINESS INTELLIGENCE SPECIFIC
# ==============================================================================
# Jorge's Business Rules
JORGE_COMMISSION_RATE=0.06
JORGE_QUALIFICATION_THRESHOLD=70
JORGE_HOT_LEAD_THRESHOLD=3
JORGE_WARM_LEAD_THRESHOLD=2

# Dashboard Configuration
DASHBOARD_AUTO_REFRESH_SECONDS=30
DASHBOARD_MAX_DATA_POINTS=1000
DASHBOARD_CACHE_STRATEGY=aggressive

# Revenue Intelligence
REVENUE_FORECAST_DAYS=90
REVENUE_CONFIDENCE_THRESHOLD=0.8
REVENUE_PREDICTION_MODEL=prophet_ensemble

# Bot Performance Analytics
BOT_PERFORMANCE_WINDOW_MINUTES=5
BOT_HEALTH_CHECK_INTERVAL=60
BOT_ALERT_THRESHOLD_MS=100

# ==============================================================================
# EXTERNAL SERVICES
# ==============================================================================
# Email Service (for alerts)
SMTP_HOST=${SMTP_HOST}
SMTP_PORT=587
SMTP_USERNAME=${SMTP_USERNAME}
SMTP_PASSWORD=${SMTP_PASSWORD}
SMTP_TLS=true

# Slack Integration (for alerts)
SLACK_WEBHOOK_URL=${SLACK_WEBHOOK_URL}
SLACK_CHANNEL=#jorge-bi-alerts
SLACK_USERNAME=Jorge-BI-Bot

# SMS Service (for critical alerts)
TWILIO_ACCOUNT_SID=${TWILIO_SID}
TWILIO_AUTH_TOKEN=${TWILIO_TOKEN}
TWILIO_FROM_NUMBER=${TWILIO_NUMBER}

# ==============================================================================
# BACKUP & DATA RETENTION
# ==============================================================================
# Data Retention Policies
ANALYTICS_RETENTION_DAYS=365
CONVERSATION_RETENTION_DAYS=90
LOG_RETENTION_DAYS=30
METRICS_RETENTION_DAYS=180

# Backup Configuration
BACKUP_ENABLED=true
BACKUP_SCHEDULE="0 2 * * *"  # Daily at 2 AM
BACKUP_STORAGE_TYPE=s3
BACKUP_S3_BUCKET=${BACKUP_S3_BUCKET}
BACKUP_RETENTION_DAYS=90

# ==============================================================================
# SCALING & LOAD BALANCING
# ==============================================================================
# Horizontal Scaling
MIN_REPLICAS=2
MAX_REPLICAS=10
TARGET_CPU_UTILIZATION=70
TARGET_MEMORY_UTILIZATION=80

# Load Balancer Configuration
LOAD_BALANCER_STRATEGY=round_robin
LOAD_BALANCER_HEALTH_CHECK_PATH=/health
LOAD_BALANCER_TIMEOUT=30

# ==============================================================================
# ERROR HANDLING & ALERTING
# ==============================================================================
# Error Thresholds
ERROR_RATE_THRESHOLD=0.05     # 5%
RESPONSE_TIME_THRESHOLD=1000  # 1 second
MEMORY_USAGE_THRESHOLD=85     # 85%
CPU_USAGE_THRESHOLD=80        # 80%

# Alert Configuration
ALERT_EMAIL=${ALERT_EMAIL}
ALERT_PHONE=${ALERT_PHONE}
CRITICAL_ALERT_ESCALATION_MINUTES=15
WARNING_ALERT_ESCALATION_MINUTES=60

# ==============================================================================
# FEATURE FLAGS
# ==============================================================================
# Feature Toggles
ENABLE_PREDICTIVE_INSIGHTS=true
ENABLE_ANOMALY_DETECTION=true
ENABLE_REAL_TIME_STREAMING=true
ENABLE_ADVANCED_ANALYTICS=true
ENABLE_AI_CONCIERGE=true

# Experimental Features
ENABLE_ML_OPTIMIZATION=true
ENABLE_CACHE_WARMING=true
ENABLE_PERFORMANCE_PROFILING=false
ENABLE_DEBUG_ENDPOINTS=false

# ==============================================================================
# COMPLIANCE & GOVERNANCE
# ==============================================================================
# Data Privacy
GDPR_ENABLED=true
CCPA_ENABLED=true
DATA_ENCRYPTION_AT_REST=true
DATA_ENCRYPTION_IN_TRANSIT=true

# Audit Logging
AUDIT_LOG_ENABLED=true
AUDIT_LOG_LEVEL=INFO
AUDIT_LOG_RETENTION_DAYS=2555  # 7 years

# Compliance Reporting
COMPLIANCE_REPORT_ENABLED=true
COMPLIANCE_REPORT_SCHEDULE="0 1 1 * *"  # Monthly

# ==============================================================================
# PRODUCTION VALIDATION CHECKLIST
# ==============================================================================
# The following must be verified before production deployment:
#
# ✅ DATABASE CONNECTIVITY:
#   - Primary database connection works
#   - Read replica connection works
#   - Connection pooling configured
#   - SSL/TLS enabled
#
# ✅ REDIS CLUSTER:
#   - All Redis nodes accessible
#   - Authentication enabled
#   - Cluster failover tested
#
# ✅ AI SERVICES:
#   - Anthropic API key valid and working
#   - Rate limits configured
#   - Fallback mechanisms tested
#
# ✅ SECURITY:
#   - All secrets are production-strength (32+ chars)
#   - HTTPS enforced for all traffic
#   - CORS configured correctly
#   - Authentication working
#
# ✅ MONITORING:
#   - Prometheus metrics collection working
#   - Grafana dashboards accessible
#   - Alerts configured and tested
#   - Log aggregation working
#
# ✅ PERFORMANCE:
#   - Load testing completed
#   - Performance thresholds met
#   - Auto-scaling configured
#   - Cache hit rates optimal
#
# ✅ BACKUP & RECOVERY:
#   - Backup strategy tested
#   - Recovery procedures validated
#   - Data retention policies active
#
# Run validation: python scripts/validate-bi-production-config.py
#
# ==============================================================================