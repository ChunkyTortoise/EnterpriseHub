{# 
  Jorge Bot Email Alert Template
  Used for email notifications via SMTP
  
  Variables available:
  - alert_id: Unique alert identifier
  - rule_name: Name of the triggered rule
  - severity: Alert severity (critical, warning, info)
  - message: Alert message
  - triggered_at: ISO timestamp of when alert was triggered
  - environment: Deployment environment (development, staging, production)
  - performance_stats: Dictionary of performance metrics
  - rule_description: Description of the alert rule
#}
{% if severity == "critical" %}
Subject: [CRITICAL] {{ rule_name }} - Jorge Bot Alert
{% elif severity == "warning" %}
Subject: [WARNING] {{ rule_name }} - Jorge Bot Alert
{% else %}
Subject: [INFO] {{ rule_name }} - Jorge Bot Alert
{% endif %}

================================================================================
                    JORGE BOT PERFORMANCE ALERT
================================================================================

Alert ID: {{ alert_id }}
Severity: {{ severity|upper }}
Rule: {{ rule_name }}
Time: {{ triggered_at }}
Environment: {{ environment|upper }}

--------------------------------------------------------------------------------

DESCRIPTION:
{{ rule_description }}

--------------------------------------------------------------------------------

DETAILS:
{{ message }}

--------------------------------------------------------------------------------

PERFORMANCE STATISTICS:
--------------------------------------------------------------------------------
{% if performance_stats %}
  {% if performance_stats.error_rate is defined %}
  Error Rate: {{ "%.2f"|format(performance_stats.error_rate * 100) }}%
  {% endif %}
  
  {% if performance_stats.cache_hit_rate is defined %}
  Cache Hit Rate: {{ "%.2f"|format(performance_stats.cache_hit_rate * 100) }}%
  {% endif %}
  
  {% if performance_stats.handoff_success_rate is defined %}
  Handoff Success Rate: {{ "%.2f"|format(performance_stats.handoff_success_rate * 100) }}%
  {% endif %}
  
  {% if performance_stats.blocked_handoffs_last_hour is defined %}
  Blocked Handoffs (1h): {{ performance_stats.blocked_handoffs_last_hour }}
  {% endif %}
  
  {% if performance_stats.rate_limit_error_rate is defined %}
  Rate Limit Error Rate: {{ "%.2f"|format(performance_stats.rate_limit_error_rate * 100) }}%
  {% endif %}
  
  {% if performance_stats.lead_bot %}
  Lead Bot:
    - P50 Latency: {{ performance_stats.lead_bot.p50_latency_ms|default(0) }}ms
    - P95 Latency: {{ performance_stats.lead_bot.p95_latency_ms|default(0) }}ms
    - P99 Latency: {{ performance_stats.lead_bot.p99_latency_ms|default(0) }}ms
  {% endif %}
  
  {% if performance_stats.buyer_bot %}
  Buyer Bot:
    - P50 Latency: {{ performance_stats.buyer_bot.p50_latency_ms|default(0) }}ms
    - P95 Latency: {{ performance_stats.buyer_bot.p95_latency_ms|default(0) }}ms
    - P99 Latency: {{ performance_stats.buyer_bot.p99_latency_ms|default(0) }}ms
  {% endif %}
  
  {% if performance_stats.seller_bot %}
  Seller Bot:
    - P50 Latency: {{ performance_stats.seller_bot.p50_latency_ms|default(0) }}ms
    - P95 Latency: {{ performance_stats.seller_bot.p95_latency_ms|default(0) }}ms
    - P99 Latency: {{ performance_stats.seller_bot.p99_latency_ms|default(0) }}ms
  {% endif %}
{% else %}
  No performance statistics available.
{% endif %}

--------------------------------------------------------------------------------

ACTION REQUIRED:
{% if severity == "critical" %}
  IMMEDIATE ACTION REQUIRED: This alert indicates a critical issue that may be
  impacting user experience or system stability.
  
  Recommended actions:
  1. Check system logs for errors
  2. Verify all services are running
  3. Review recent deployments
  4. Contact on-call engineer if issue persists
{% elif severity == "warning" %}
  ACTION ADVISED: This alert indicates a potential issue that should be
  investigated but may not be immediately impacting users.
  
  Recommended actions:
  1. Monitor the situation
  2. Review relevant metrics
  3. Plan remediation if trend continues
{% else %}
  INFORMATIONAL: This alert is for informational purposes.
  
  Recommended actions:
  1. Review as time permits
  2. Document if pattern emerges
{% endif %}

--------------------------------------------------------------------------------

This alert was generated by Jorge Bot Alerting System.
To adjust alert settings, update your configuration files or environment variables.

================================================================================
